(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
View(missed)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
View(data1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
data1 %>%  filter(data1$defence_def_rtg > 2500)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg+fta+drb+stl+tov+pts+fga_per_min+fg2_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+pf_per_poss+pts_per_poss+off_rtg+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+G+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct.1+AdjTempo_x+OE_x+AdjOE_x+DE_x+AdjDE_x+AdjEM_x+Tempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+Conf_Rk_x+Conf_Rating_x+Conf_Rk_y+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+KP_Conf_Dif, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg', 'fta', 'drb', 'stl', 'tov', 'pts', 'fga_per_min', 'fg2_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'pf_per_poss', 'pts_per_poss', 'off_rtg', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'G', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct.1', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'DE_x', 'AdjDE_x', 'AdjEM_x', 'Tempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rk_y', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'KP_Conf_Dif')
columns_subset <-  test[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- test[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
# Load libraries
library(tidyverse)
library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#data1 %>%  filter(data1$defence_def_rtg > 2500)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg+fta+drb+stl+tov+pts+fga_per_min+fg2_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+pf_per_poss+pts_per_poss+off_rtg+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+G+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct.1+AdjTempo_x+OE_x+AdjOE_x+DE_x+AdjDE_x+AdjEM_x+Tempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+Conf_Rk_x+Conf_Rating_x+Conf_Rk_y+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+KP_Conf_Dif, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg', 'fta', 'drb', 'stl', 'tov', 'pts', 'fga_per_min', 'fg2_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'pf_per_poss', 'pts_per_poss', 'off_rtg', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'G', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct.1', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'DE_x', 'AdjDE_x', 'AdjEM_x', 'Tempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rk_y', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'KP_Conf_Dif')
columns_subset <-  test[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg+fta+drb+stl+tov+pts+fga_per_min+fg2_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+pf_per_poss+pts_per_poss+off_rtg+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+G+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct.1+AdjTempo_x+OE_x+AdjOE_x+DE_x+AdjDE_x+AdjEM_x+Tempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+Conf_Rk_x+Conf_Rating_x+Conf_Rk_y+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+KP_Conf_Dif, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg', 'fta', 'drb', 'stl', 'tov', 'pts', 'fga_per_min', 'fg2_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'pf_per_poss', 'pts_per_poss', 'off_rtg', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'G', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct.1', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'DE_x', 'AdjDE_x', 'AdjEM_x', 'Tempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rk_y', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'KP_Conf_Dif')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg+fta+drb+stl+tov+pts+fga_per_min+fg2_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+pf_per_poss+pts_per_poss+off_rtg+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+G+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct.1+AdjTempo_x+OE_x+AdjOE_x+DE_x+AdjDE_x+AdjEM_x+Tempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+Conf_Rk_x+Conf_Rating_x+Conf_Rk_y+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+KP_Conf_Dif, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg', 'fta', 'drb', 'stl', 'tov', 'pts', 'fga_per_min', 'fg2_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'pf_per_poss', 'pts_per_poss', 'off_rtg', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'G', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct.1', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'DE_x', 'AdjDE_x', 'AdjEM_x', 'Tempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rk_y', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'KP_Conf_Dif')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.75))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg+fta+drb+stl+tov+pts+fga_per_min+fg2_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+pf_per_poss+pts_per_poss+off_rtg+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+G+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct.1+AdjTempo_x+OE_x+AdjOE_x+DE_x+AdjDE_x+AdjEM_x+Tempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+Conf_Rk_x+Conf_Rating_x+Conf_Rk_y+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+KP_Conf_Dif, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg', 'fta', 'drb', 'stl', 'tov', 'pts', 'fga_per_min', 'fg2_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'pf_per_poss', 'pts_per_poss', 'off_rtg', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'G', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct.1', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'DE_x', 'AdjDE_x', 'AdjEM_x', 'Tempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rk_y', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'KP_Conf_Dif')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.99))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
data1$offence.describe()
describe(data1$offence)
data1$offence.summary()
summary(data1$offence)
# Load libraries
library(tidyverse)
library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#data1 %>%  filter(data1$defence_def_rtg > 2500)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~  player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+Calc A2, data = train)
model.lm <- lm(offence ~  player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf, data = train)
model.lm <- lm(offence ~  player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss, data = train)
model.lm <- lm(offence ~  player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss, data = train)
model.lm <- lm(offence ~  player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss, data = train)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct
+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate, data = train)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+Calc A2, data = train)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif, data = train)
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+'Calc A2', data = train)
# Load libraries
library(tidyverse)
library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(missed)
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
View(missed)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.95)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
glance(model.lm)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.65)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.65))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.65)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(results_test_set_CI)
View(results_test_set_CI)
View(missed)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.95))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.65)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
# Load libraries
library(tidyverse)
#library(cbcTools)
library(readr)
library(here)
library(ggplot2)
library(dplyr)
library(broom)
#make this example reproducible
set.seed(1)
data1 <- read_csv(here('Data folder', 'training_data_to_use.csv'))
#create ID column
data1$id <- 1:nrow(data1)
#use 70% of dataset as training set and 30% as test set
train <- data1 %>% dplyr::sample_frac(0.80)
test  <- dplyr::anti_join(data1, train, by = 'id')
model.lm <- lm(offence ~ player_type+games+games_started+mp_per_g+fg_per_g+fga_per_g+fg2_per_g+fg2a_per_g+fg3_per_g+fg3a_per_g+ft_per_g+fta_per_g+orb_per_g+drb_per_g+trb_per_g+ast_per_g+stl_per_g+blk_per_g+tov_per_g+pf_per_g+pts_per_g+sos+fg2+fg2a+ft+fta+stl+pf
+fg_per_min+fga_per_min+fg2_per_min+fg2a_per_min+fg3_per_min+fg3a_per_min+ft_per_min+fta_per_min+trb_per_min+ast_per_min+stl_per_min+blk_per_min+tov_per_min+pf_per_min+pts_per_min+fg_per_poss+fga_per_poss+fg2_per_poss+fg2a_per_poss+fg3_per_poss
+fg3a_per_poss+ft_per_poss+fta_per_poss+trb_per_poss+ast_per_poss+stl_per_poss+blk_per_poss+tov_per_poss+pf_per_poss+pts_per_poss+def_rtg+per+ts_pct+efg_pct+fg3a_per_fga_pct+fta_per_fga_pct+orb_pct+drb_pct+trb_pct+ast_pct+stl_pct+blk_pct+tov_pct+usg_pct+ows+dws+ws+ws_per_40+obpm+dbpm+bpm+year+Ht+S+X.Min+ORtg+X.Poss+X.Shots+eFG.+TS.+OR.+DR.+ARate
+TORate+Blk.+Stl.+FC.40+FD.40+Pct.2+X.Pct+X.Pct.1+Tempo_x+AdjTempo_x+OE_x+AdjOE_x+AdjDE_x+AdjEM_x+seed_x+Tempo_y+AdjTempo_y+OE_y+AdjOE_y+DE_y+AdjDE_y+AdjEM_y+seed_y+Conf_Rk_x+Conf_Rating_x+Conf_Rating_y+year_max_x+games_max_x+games_max_y+Team_AdjEM_dif+CalcA2, data = train)
summary(model.lm)
columns_to_use <- c('player_type', 'games', 'games_started', 'mp_per_g', 'fg_per_g', 'fga_per_g', 'fg2_per_g', 'fg2a_per_g', 'fg3_per_g', 'fg3a_per_g', 'ft_per_g', 'fta_per_g', 'orb_per_g', 'drb_per_g', 'trb_per_g', 'ast_per_g', 'stl_per_g', 'blk_per_g', 'tov_per_g', 'pf_per_g', 'pts_per_g', 'sos', 'fg2', 'fg2a', 'ft', 'fta', 'stl', 'pf', 'fg_per_min', 'fga_per_min', 'fg2_per_min', 'fg2a_per_min', 'fg3_per_min', 'fg3a_per_min', 'ft_per_min', 'fta_per_min', 'trb_per_min', 'ast_per_min', 'stl_per_min', 'blk_per_min', 'tov_per_min', 'pf_per_min', 'pts_per_min', 'fg_per_poss', 'fga_per_poss', 'fg2_per_poss', 'fg2a_per_poss', 'fg3_per_poss', 'fg3a_per_poss', 'ft_per_poss', 'fta_per_poss', 'trb_per_poss', 'ast_per_poss', 'stl_per_poss', 'blk_per_poss', 'tov_per_poss', 'pf_per_poss', 'pts_per_poss', 'def_rtg', 'per', 'ts_pct', 'efg_pct', 'fg3a_per_fga_pct', 'fta_per_fga_pct', 'orb_pct', 'drb_pct', 'trb_pct', 'ast_pct', 'stl_pct', 'blk_pct', 'tov_pct', 'usg_pct', 'ows', 'dws', 'ws', 'ws_per_40', 'obpm', 'dbpm', 'bpm', 'year', 'Ht', 'S', 'X.Min', 'ORtg', 'X.Poss', 'X.Shots', 'eFG.', 'TS.', 'OR.', 'DR.', 'ARate', 'TORate', 'Blk.', 'Stl.', 'FC.40', 'FD.40', 'Pct.2', 'X.Pct', 'X.Pct.1', 'Tempo_x', 'AdjTempo_x', 'OE_x', 'AdjOE_x', 'AdjDE_x', 'AdjEM_x', 'seed_x', 'Tempo_y', 'AdjTempo_y', 'OE_y', 'AdjOE_y', 'DE_y', 'AdjDE_y', 'AdjEM_y', 'seed_y', 'Conf_Rk_x', 'Conf_Rating_x', 'Conf_Rating_y', 'year_max_x', 'games_max_x', 'games_max_y', 'Team_AdjEM_dif', 'CalcA2')
columns_subset <-  data1[columns_to_use]#%>% sample_n(5)
#new.dat <- data.frame(speed1)
results_test_set_CI <-as.data.frame(predict(model.lm, newdata = columns_subset, interval = 'confidence', level = 0.99))
results_test_set_CI$actual_value <- data1[c('offence')]
predict(model.lm, newdata = columns_subset, interval = 'prediction', level = 0.65)
glance(model.lm)
missed <- (results_test_set_CI %>%
filter(  ((results_test_set_CI$actual_value > results_test_set_CI$upr) |
(results_test_set_CI$actual_value < results_test_set_CI$lwr)) )
)
summary(data1$offence)
View(missed)
